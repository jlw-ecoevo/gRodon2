names(genome)
grep("ribosomal",names(genome))
names(genome)[grep("ribosomal protein",names(genome),ignore.case = T)]
names(genome)[grep("ribosomal",names(genome),ignore.case = T)]
he <- grep("ribosomal protein|ribosomal subunit protein",names(genome),ignore.case = T)
he <- grepl("ribosomal protein|ribosomal subunit protein",names(genome),ignore.case = T)
predictGrowth(genome,he)
library(gRodon)
library(gRodon2)
install.packages("devtools")
BiocManager::install("coRdon")
devtools::install_github("jlw-ecoevo/gRodon2")
library(gRodon)
library(Biostrings)
genome <- readDNAStringSet("C:/Users/jlwei/Downloads/ncbi_dataset/ncbi_dataset/data/GCF_000005845.2/cds_from_genomic.fna")
he <- grepl("ribosomal protein|ribosomal subunit protein",names(genome),ignore.case = T)
predictGrowth(genome,he)
predictGrowth(genome,he,temperature = 40)
predictGrowth(genome,he,temperature = 45)
genome <- readDNAStringSet("C:/Users/jlwei/Downloads/ncbi_dataset (1)/ncbi_dataset/data/GCF_000008865.2/cds_from_genomic.fna")
he <- grepl("ribosomal protein|ribosomal subunit protein",names(genome),ignore.case = T)
predictGrowth(genome,he)
sampB <- function(){sample(0:1,1000,replace=T)}
sampB <- function(){sample(0:1,1000,replace=T)  %>% mean()}
sampB
sampB <- function(){sample(0:1,1000,replace=T)  %>% mean() %>% return()}
sampB
sampB()
library(dplyr)
sampB
sampB()
sampB()
sampB()
sampB()
x <- apply(1000,sampB)
sampB <- function(x){sample(0:1,1000,replace=T)  %>% mean() %>% return()}
x <- apply(1000,sampB)
x <- apply(1:1000,sampB)
x <- lapply(1:1000,sampB)
hist(x)
hist(unlist(x))
# Load Packages ----------------------------------------------------------------
library(dplyr)
library(data.table)
library(Biostrings)
library(stringr)
library(MASS)
library(ggplot2)
library(ggpubr)
library(car)
library(lmtest)
library(reshape2)
library(psych)
library(corrplot)
library(quantreg)
library(egg)
library(ggfortify)
library(cluster)
#for genome family sampling
set.seed(2025)
# Helper Functions -------------------------------------------------------------
boxcoxTransform <- function(x, lambda, back_transform = F) {
if (back_transform == TRUE) {
(x*lambda +1)^(1/lambda)  %>% return()
} else {
(((x^lambda) - 1) / lambda) %>% return()
}
}
merge.easy <- function(df1,df2,key){
df1 <- data.table(df1,key=key)
df2 <- data.table(df2,key=key)
return(unique(merge(df1,df2,all.x=TRUE,by=.EACHI,allow.cartesian=TRUE)))
}
rgrep <- function(big,small_vec){
small_vec[lapply(small_vec,grepl,x=big) %>% unlist()]
}
load("cog_counts.rda")
setwd("C:/Users/jlwei/OneDrive - Stony Brook University/copiotrophy/")
load("cog_counts.rda")
fam_cog_df <- merge.easy(pred_df,cog_df,key="Genome") %>%
subset(!is.na(arCOG00022)) %>%
group_by(Family) %>%
sample_n(1)
setwd("C:/Users/jlwei/Documents/gRodon2/inst/extdata")
setwd("C:/Users/jlwei/OneDrive - Stony Brook University/copiotrophy/")
load("cog_mods.rda")
x <- colSums(cog_df)
setwd("C:/Users/jlwei/OneDrive - Stony Brook University/copiotrophy/")
load("cog_mods.rda")
cogdef <- read.delim("cog-20.def.tab",header=F) %>%
mutate(COG=V1,
COGCAT=V2,
Def=V3) %>%
subset(select=c(COG,COGCAT,Def))
arcogdef <- read.delim("ar14.arCOGdef.tab",header=T) %>%
mutate(COG=CLU,
COGCAT=FUNC_ONE,
Def=Annotation) %>%
subset(select=c(COG,COGCAT,Def))
cogdef <- rbind(cogdef,arcogdef)
mod_sum <- merge.easy(mod_sum,cogdef,key="COG")
mod_p <- p.adjust(c(mod_sum$p.dCUB,mod_sum$p.OGT),method="BH")
mod_sum$p.dCUB.adj <- mod_p[1:nrow(mod_sum)]
mod_sum$p.OGT.adj <- mod_p[(nrow(mod_sum)+1):length(mod_p)]
mod_sum$ABC <- grepl("ABC",mod_sum$Def)
ggplot(mod_sum,aes(x=Coef.dCUB,
y=-log10(p.dCUB.adj))) +
geom_point() +
geom_hline(yintercept=-log10(0.05),lty=2,col="red") +
xlim(-50,50) +
theme_pubclean()
ggplot(mod_sum,aes(x=Coef.OGT,
y=-log10(p.OGT.adj))) +
geom_point() +
geom_hline(yintercept=-log10(0.05),lty=2,col="red") +
xlim(-1,1) +
theme_pubclean()
cub_cog <- mod_sum %>%
subset(p.dCUB.adj < 0.01 & p.OGT.adj<0.01)
ggplot(cub_cog,aes(x=-Coef.dCUB,y=Coef.OGT,color=ABC)) +
geom_point(alpha=0.75,size=2) +
theme_pubclean() +
theme(legend.position = "none") +
scale_color_brewer(palette="Set1")
cog_a <- cub_cog$COG[cub_cog$Coef.dCUB < 0 & cub_cog$Coef.OGT < 0]
cog_b <- cub_cog$COG[cub_cog$Coef.dCUB > 0 & cub_cog$Coef.OGT > 0]
cog_ab <- cog_df[,c("Genome",cog_a,cog_b)]
cog_a
cog_df$A <- cog_df[,c(cog_a)] %>% rowsum()
cog_df$A <- cog_df[,c(cog_a)] %>% rowSums()
cog_df$A
cog_df$A %>% hist()
cog_df$A <- (cog_df[,c(cog_a)]>0) %>% rowSums()
cog_df$A %>% hist()
cog_df$B<- (cog_df[,c(cog_b)]>0) %>% rowSums()
cog_df$B %>% hist()
cat_dg <- cog_df %>% subset(select=c(Genome,A,B))
cat_df <- cog_df %>% subset(select=c(Genome,A,B))
head(cat_df)
plot(A~B,data=cat_df)
library(dplyr)
library(data.table)
library(Biostrings)
library(stringr)
library(MASS)
library(ggplot2)
library(ggpubr)
library(car)
library(lmtest)
library(reshape2)
library(psych)
library(corrplot)
library(quantreg)
library(egg)
library(ggfortify)
library(cluster)
#for genome family sampling
set.seed(2025)
boxcoxTransform <- function(x, lambda, back_transform = F) {
if (back_transform == TRUE) {
(x*lambda +1)^(1/lambda)  %>% return()
} else {
(((x^lambda) - 1) / lambda) %>% return()
}
}
merge.easy <- function(df1,df2,key){
df1 <- data.table(df1,key=key)
df2 <- data.table(df2,key=key)
return(unique(merge(df1,df2,all.x=TRUE,by=.EACHI,allow.cartesian=TRUE)))
}
rgrep <- function(big,small_vec){
small_vec[lapply(small_vec,grepl,x=big) %>% unlist()]
}
setwd("C:/Users/jlwei/Documents/madin_genomes")
load("polyproline_counts.rda")
setwd("C:/Users/jlwei/OneDrive - Stony Brook University/temp_range/")
rrna <- read.delim("rrnDB-5.9_pantaxa_stats_NCBI.tsv",header=T) %>%
mutate(Species=name,rRNA=median) %>%
subset(select=c(Species,rRNA))
cazy <- read.delim("dbcan_counts2_gtdb220.tsv",header=F) %>%
mutate(Genome=substr(V1,4,18),
nCAZy=V2) %>%
subset(select=c(Genome,nCAZy))
setwd("C:/Users/jlwei/OneDrive - Stony Brook University/gRodon3")
load("gtdb220_genome_predictions_20Cm.rda")
efp <- pred_df %>% subset(select=c(Genome,EFP))
setwd("C:/Users/jlwei/OneDrive - Stony Brook University/ioc_gtdb/")
load("gtdb220_genome_predictions_temp.rda")
taxonomy <- rbind(read.delim("bac120_taxonomy_r220.tsv",header = F),
read.delim("ar53_taxonomy_r220.tsv",header = F)) %>%
mutate(Genome=substr(V1,4,18),
Genus=gsub(";s__.*","",V2),
Family=gsub(";g__.*","",V2),
Phylum=gsub(";c__.*","",V2),
Taxonomy=V2)
pred_df <- merge.easy(pred_df,taxonomy,key="Genome") %>%
as.data.frame(stringsAsFactors=F)
pred_df$Species <- pred_df$V2 %>%
gsub(pattern=".*s__",replace="")
rownames(pred_df) <- pred_df$Species
pred_df <- pred_df  %>%
merge.easy(.,efp,key="Genome") %>%
merge.easy(.,cazy,key="Genome") %>%
merge.easy(.,rrna,key="Species")
setwd("C:/Users/jlwei/OneDrive - Stony Brook University/copiotrophy/")
load("cogcat_counts.rda")
names(cogcat_df)[27] <- "Genome"
fam_df <- merge.easy(pred_df,cogcat_df,key="Genome") %>%
subset(!is.na(A)) %>%
group_by(Family) %>%
sample_n(1)
load("cog_counts.rda")
fam_cog_df <- merge.easy(pred_df,cog_df,key="Genome") %>%
subset(!is.na(arCOG00022)) %>%
group_by(Family) %>%
sample_n(1)
setwd("C:/Users/jlwei/Documents/gRodon2/inst/extdata")
setwd("~/GitHub/gRodon2/inst/extdata/")
# setwd("~/GitHub/gRodon2/inst/extdata/")
load("GrowthRates_Madin.rda")
load("CodonStatistics_GC.rda")
load("Accession2Species_Madin.rda")
temps <- rbind(read.csv("bacteria_ncbi_temperatures.csv"),
read.csv("archaea_ncbi_temperatures.csv")) %>%
mutate(Accession=gsub("[.].*","",Assembly) %>% gsub(pattern="GCA",replace="GCF"))
cu <- cu %>% mutate_all(unlist)
names(d)[1] <- "Species"
d <- d %>% as.data.frame(stringsAsFactors=F)
# Merge datasets
rownames(spp_acc) <- spp_acc$V1 %>% gsub(pattern="[.].*",replace="")
cu$Accession <- cu$File %>% gsub(pattern="[.].*",replace="")
pp_df$Accession <- pp_df$Accession %>% gsub(pattern="[.].*",replace="")
cu$Spp <- spp_acc[cu$Accession,"V2"]
cu$Species <- lapply(cu$Spp,rgrep,small_vec=d$Species) %>%
lapply("[",1) %>% unlist()
cu$Species[cu$Spp %in% d$Species] <- cu$Spp[cu$Spp %in% d$Species]
cu <- merge.easy(cu,pp_df,key="Accession")
cu$PPpropP <- cu$PP/cu$P
cu$PPpropPHE <- cu$PPHE/cu$PHE
cu$PPprop <- cu$PP/cu$bp
cu$PPpropHE <- cu$PPHE/cu$bpHE
cu$PPprop2 <- (cu$PP-cu$bp)/cu$bp
cu <- merge.easy(cu,d,key="Species") %>%
subset(!is.na(Species)) %>%
merge.easy(.,temps,key="Accession")
head(fam_df)
cog_df$CatA <- (cog_df[,c(cog_a)]>0) %>% rowSums()
cog_df$CatB<- (cog_df[,c(cog_b)]>0) %>% rowSums()
cat_df <- cog_df %>% subset(select=c(Genome,CatA,CatB))
x <- merge.easy(fam_df,cat_df,key="Genome")
ggplot(fam_df,x=OGT,y=dCUB,color=CatA) +
geom_point()
ggplot(fam_df,x=OGT,y=dCUB) +
geom_point()
ggplot(fam_df,aes(x=OGT,y=dCUB,color=CatA)) +
geom_point()
head(cat_df)
x <- merge.easy(fam_df,cat_df,key="Genome")
fam_df$CatA
head(cat_df)
head(fam_df)
ggplot(x,aes(x=OGT,y=dCUB,color=CatA)) +
geom_point()
ggplot(x,aes(x=OGT,y=-dCUB,color=CatA)) +
geom_point() +
theme_pubclean()
ggplot(x,aes(x=OGT,y=-dCUB,color=CatA)) +
geom_point() +
theme_pubclean()+
scale_color_manual(values=c("white","black"))
ggplot(x,aes(x=OGT,y=-dCUB,color=CatA)) +
geom_point() +
theme_pubclean()+
scale_color_gradient(low="white",high="black")
ggplot(x,aes(x=OGT,y=-dCUB,fill=CatA)) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_gradient(low="white",high="black")
ggplot(x,aes(x=OGT,y=-dCUB,fill=log10(CatA))) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_gradient(low="white",high="black")
ggplot(x,aes(x=OGT,y=-dCUB,fill=CatA)) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_gradient(low="white",high="black")
ggplot(x,aes(x=OGT,y=-dCUB,fill=CatB)) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_gradient(low="white",high="black")
ggplot(x,aes(x=OGT,y=-dCUB,fill=CatA)) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_gradient(low="white",high="black") +
scale_fill_viridis_c()
ggplot(x,aes(x=OGT,y=-dCUB,fill=CatA)) +
geom_point(pch=21,alpha=0.75) +
theme_pubclean()+
scale_fill_gradient(low="white",high="black") +
scale_fill_viridis_c()
ggplot(x,aes(x=OGT,y=-dCUB,fill=CatB)) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_viridis_c()
ggplot(x,aes(x=OGT,y=-dCUB,fill=CatA)) +
geom_point(pch=21,alpha=0.75) +
theme_pubclean()+
scale_fill_viridis_c() +
theme(legend.position = "right") +
labs(fill="Number Genes\nGroup A")
ggplot(x,aes(x=OGT,y=-dCUB,fill=CatB)) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_viridis_c() + +
labs(fill="Number Genes\nGroup B")
ggplot(x,aes(x=OGT,y=-dCUB,fill=CatB)) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_viridis_c() + +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
ggplot(x,aes(x=OGT,y=-dCUB,fill=CatB)) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_viridis_c() +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(fam_df$dCUB,na.rm=T),fill=CatA)) +
geom_point(pch=21,alpha=0.75) +
theme_pubclean()+
scale_fill_viridis_c() +
theme(legend.position = "right") +
labs(fill="Number Genes\nGroup A")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(fam_df$dCUB,na.rm=T),fill=CatB)) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_viridis_c() +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
?scale_fill_viridis_c
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(fam_df$dCUB,na.rm=T),fill=CatA)) +
geom_point(pch=21,alpha=0.75) +
theme_pubclean()+
scale_fill_viridis_c(option="G") +
theme(legend.position = "right") +
labs(fill="Number Genes\nGroup A")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(fam_df$dCUB,na.rm=T),fill=CatA)) +
geom_point(pch=21,alpha=0.75) +
theme_pubclean()+
scale_fill_viridis_c(option="A") +
theme(legend.position = "right") +
labs(fill="Number Genes\nGroup A")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(fam_df$dCUB,na.rm=T),fill=CatA)) +
geom_point(pch=21,alpha=0.75) +
theme_pubclean()+
scale_fill_viridis_c(option="A",direction=-1) +
theme(legend.position = "right") +
labs(fill="Number Genes\nGroup A")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(fam_df$dCUB,na.rm=T),fill=CatA)) +
geom_point(pch=21,alpha=0.75) +
theme_pubclean()+
scale_fill_viridis_c(option="A") +
theme(legend.position = "right") +
labs(fill="Number Genes\nGroup A")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(fam_df$dCUB,na.rm=T),fill=CatA)) +
geom_point(pch=21,alpha=0.75) +
theme_pubclean()+
scale_fill_viridis_c(option="B") +
theme(legend.position = "right") +
labs(fill="Number Genes\nGroup A")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(fam_df$dCUB,na.rm=T),fill=CatA)) +
geom_point(pch=21,alpha=0.75) +
theme_pubclean()+
scale_fill_viridis_c(option="C") +
theme(legend.position = "right") +
labs(fill="Number Genes\nGroup A")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(fam_df$dCUB,na.rm=T),fill=CatB)) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(fam_df$dCUB,na.rm=T),fill=CatA)) +
geom_point(pch=21,alpha=0.75) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
theme(legend.position = "right") +
labs(fill="Number Genes\nGroup A")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(fam_df$dCUB,na.rm=T),fill=CatA)) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
theme(legend.position = "right") +
labs(fill="Number Genes\nGroup A")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(fam_df$dCUB,na.rm=T),fill=CatB)) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
?rgb
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(x$dCUB,na.rm=T))) +
geom_point(pch=21,alpha=0.5,fill=rgb(x$CatA/max(x$CatA),1,x$CatB/max(x$CatB))) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(x$dCUB,na.rm=T))) +
geom_point(pch=21,alpha=0.5,fill=rgb(x$CatA/max(x$CatA),0,x$CatB/max(x$CatB))) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(x$dCUB,na.rm=T))) +
geom_point(pch=21,
alpha=max(c(x$CatA/max(x$CatA),x$CatB/max(x$CatB))),
fill=rgb(x$CatA/max(x$CatA),0,x$CatB/max(x$CatB))) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(x$dCUB,na.rm=T))) +
geom_point(pch=21,
alpha=max(c(x$CatA/max(x$CatA),x$CatB/max(x$CatB)))*0.8,
fill=rgb(x$CatA/max(x$CatA),0,x$CatB/max(x$CatB))) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(x$dCUB,na.rm=T))) +
geom_point(pch=21,
alpha=max(c(x$CatA/max(x$CatA),x$CatB/max(x$CatB)))*0.8,
fill=rgb(x$CatA/max(x$CatA),0,x$CatB/max(x$CatB)),
size=2) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(x$dCUB,na.rm=T))) +
geom_point(pch=21,
alpha=max(c(x$CatA/max(x$CatA),x$CatB/max(x$CatB)))*0.75,
fill=rgb(x$CatA/max(x$CatA),0,x$CatB/max(x$CatB)),
size=2) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
hist(max(c(x$CatA/max(x$CatA),x$CatB/max(x$CatB)))*0.75)
hist(pmax(c(x$CatA/max(x$CatA),x$CatB/max(x$CatB)))*0.75)
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(x$dCUB,na.rm=T))) +
geom_point(pch=21,
alpha=pmax(c(x$CatA/max(x$CatA),x$CatB/max(x$CatB)))*0.75,
fill=rgb(x$CatA/max(x$CatA),0,x$CatB/max(x$CatB)),
size=2) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(x$dCUB,na.rm=T))) +
geom_point(pch=21,
aes(alpha=pmax(c(x$CatA/max(x$CatA),x$CatB/max(x$CatB)))*0.75),
fill=rgb(x$CatA/max(x$CatA),0,x$CatB/max(x$CatB)),
size=2) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
pmax(c(x$CatA/max(x$CatA),x$CatB/max(x$CatB)))*0.75
pmax(c(x$CatA/max(x$CatA),x$CatB/max(x$CatB)))*0.75 %>% length()
length(alpha=pmax(c(x$CatA/max(x$CatA),x$CatB/max(x$CatB)))*0.75)
length(pmax(c(x$CatA/max(x$CatA),x$CatB/max(x$CatB)))*0.75)
length(pmax(x$CatA/max(x$CatA),x$CatB/max(x$CatB))*0.75,)
length(pmax(x$CatA/max(x$CatA),x$CatB/max(x$CatB)))
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(x$dCUB,na.rm=T))) +
geom_point(pch=21,
alpha=pmax(x$CatA/max(x$CatA),x$CatB/max(x$CatB)),
fill=rgb(x$CatA/max(x$CatA),0,x$CatB/max(x$CatB)),
size=2) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(x$dCUB,na.rm=T))) +
geom_point(pch=21,
alpha=pmax(x$CatA/max(x$CatA),x$CatB/max(x$CatB))*0.75,
fill=rgb(x$CatA/max(x$CatA),0,x$CatB/max(x$CatB)),
size=2) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(x$dCUB,na.rm=T))) +
geom_point(pch=21,
alpha=pmax(x$CatA/max(x$CatA),x$CatB/max(x$CatB))^2,
fill=rgb(x$CatA/max(x$CatA),0,x$CatB/max(x$CatB)),
size=2) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(fam_df$dCUB,na.rm=T),fill=CatA)) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
theme(legend.position = "right") +
labs(fill="Number Genes\nGroup A")
ggplot(x,aes(x=OGT,y=(-dCUB)+2*max(fam_df$dCUB,na.rm=T),fill=CatB)) +
geom_point(pch=21,alpha=0.5) +
theme_pubclean()+
scale_fill_viridis_c(option="C",direction=-1) +
labs(fill="Number Genes\nGroup B") +
theme(legend.position = "right")
